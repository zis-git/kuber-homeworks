Домашняя работа к занятию «Запуск приложений в Kubernetes» Голоха Е.В.

Выполнено на виртуальной машине:
ОС: Debian GNU/Linux 13 (trixie)
Kubernetes: microk8s v1.32.9
Container runtime: containerd
IP-адрес ВМ: 192.168.88.20

====================================================
Задание 1. Deployment и доступ к репликам приложения
====================================================

1. Создание Deployment с двумя контейнерами

Был создан Deployment с двумя контейнерами:
- nginx
- multitool

Для устранения конфликта портов HTTP-сервер multitool был перенесён на порт 8080.

Файл манифеста:
manifests/01-deploy-nginx-multitool.yaml

2. Масштабирование Deployment

Изначально Deployment был запущен с одной репликой.
После запуска количество реплик было увеличено до двух.

Команда масштабирования:
kubectl scale deployment web --replicas=2

Состояние Pod после масштабирования:

<img width="433" height="139" alt="2026-01-28_14-54-53" src="https://github.com/user-attachments/assets/6a688c08-9795-44e6-8c29-1f52172e8d25" />

3. Создание Service для доступа к репликам

Для обеспечения сетевого доступа к репликам приложения был создан Service типа ClusterIP.

Файл манифеста:
manifests/02-service-web.yaml

Применение Service:

<img width="433" height="139" alt="2026-01-28_14-54-53" src="https://github.com/user-attachments/assets/c09bef9f-2ef6-4110-8a9a-1d1ebe633ffb" />

Проверка созданного Service:

[SCREENSHOT]
screens/2026-01-28_14-55-46.png

Подробная информация о Service и endpoints:

<img width="653" height="120" alt="2026-01-28_14-55-46" src="https://github.com/user-attachments/assets/98c96cbc-74b3-41bb-ab2e-6682f32b541d" />

Service корректно маршрутизирует трафик к двум Pod приложения.

4. Проверка доступа к приложению из другого Pod

Был создан отдельный Pod с приложением multitool.

Файл манифеста:
manifests/03-multitool-pod.yaml

Создание Pod:


<img width="504" height="92" alt="2026-01-28_14-58-26" src="https://github.com/user-attachments/assets/e623698c-37c0-43cf-b91d-c2364e69c863" />

Из Pod выполнен HTTP-запрос к Service приложения:

Команда:
kubectl exec -it multitool-client -- curl http://web-svc

В ответ была получена HTML-страница nginx, что подтверждает доступ к репликам приложения.

Результат curl-запроса:


<img width="681" height="423" alt="2026-01-28_14-59-10" src="https://github.com/user-attachments/assets/102dc23f-4e55-40c7-84ff-43ddaa3b6422" />

====================================================
Задание 2. Deployment с Init Container
====================================================

1. Создание Deployment с Init Container

Был создан Deployment nginx с init-контейнером на базе busybox.
Init-контейнер ожидает появления Service перед запуском основного контейнера nginx.

Файл манифеста:
manifests/04-nginx-with-init.yaml

Применение Deployment:


<img width="566" height="53" alt="2026-01-28_15-00-42" src="https://github.com/user-attachments/assets/86e96018-38d8-4994-b365-21acd0b5da47" />

2. Проверка, что nginx не стартует без Service

После запуска Deployment Pod находится в состоянии Init,
основной контейнер nginx не стартует.

Состояние Pod до создания Service:

[SCREENSHOT]
screens/2026-01-28_15-07-00.png

Подробная информация о Pod и init-контейнере:


<img width="1524" height="981" alt="2026-01-28_15-03-25" src="https://github.com/user-attachments/assets/275bd6ac-a0f2-4d6e-9698-7f1d06e4f4fc" />

3. Создание Service и завершение init-контейнера

Был создан Service для Deployment nginx-init.

Файл манифеста:
manifests/05-nginx-init-svc.yaml

Применение Service:

<img width="656" height="54" alt="2026-01-28_15-05-49" src="https://github.com/user-attachments/assets/25765d3c-c099-405d-b965-c7c67b0a8bf1" />

После появления Service init-контейнер завершился,
и основной контейнер nginx успешно стартовал.

Состояние Pod после запуска Service:
<img width="851" height="94" alt="2026-01-28_15-18-46" src="https://github.com/user-attachments/assets/15440495-b780-45a0-9b60-c15695b64a3d" />

Итог
====================================================

В ходе выполнения домашней работы:
- Созданы Deployment с несколькими контейнерами
- Реализовано масштабирование реплик
- Настроен Service для доступа к приложениям
- Проверен сетевой доступ между Pod
- Реализован Init Container с ожиданием Service
- Продемонстрировано управление порядком запуска контейнеров
